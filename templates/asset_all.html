<!DOCTYPE html>
<html>

<head>
    <!-- Styling for the table -->
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            background-color: #f2f2f2; /* light grey */
        }

        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }

        #nameFilter {
            padding: 10px;
            margin-bottom: 15px;
            width: 30%;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        /* Add the necessary CSS styles for the slideshow and image display */
        .slideshow-container {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
            position: relative;
        }

        .mySlides {
            flex: 0 0 200px;
            margin: 5px;
            text-align: center;
            position: relative;
        }

        .mySlides img {
            width: 200px;
            height: 200px;
            object-fit: cover;
        }

        .text {
            position: absolute;
            bottom: 0;
            width: 100%;
            text-align: center;
            color: white; /* Adjust text color as needed */
            font-size: 18px; /* Adjust font size as needed */
            background-color: rgba(0, 0, 0, 0.5);
            padding: 5px 0;
        }   

        .prev, .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            color: white;
            font-weight: bold;
            font-size: 18px;
            transition: 0.6s ease;
            user-select: none;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .prev {
            left: 0;
        }

        .next {
            right: 0;
        }

        .prev:hover, .next:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }
    </style>
</head>

<body>
    <!-- Extending the base template -->
    {% extends 'base.html' %}

    <!-- Setting the title -->
    {% block title %}Asset Maintenance{% endblock %}

    <!-- Content block -->
    {% block content %}
    <!-- First Heading -->
    <h1>Asset List</h1>

    <!-- Input for filtering -->
    <input type="text" id="nameFilter" oninput="filterNames()" placeholder="Search for asset.." title="Type in a Asset Name">

    <!-- Table to display assets -->
    <table id="asset-table">
        <tr>
            <th>Name</th> 
            <th>Description</th>
        </tr>
        {% for asset in assets %}
        <tr>
            <td><a href="/asset_edit/{{ asset.id }}">{{ asset.name }}</a></td>
            <td>{{ asset.description }}</td>
        </tr>
        {% endfor %}
    </table>

    <div class="slideshow-container">
        {% for asset in assets %}
        <div class="mySlides">
            {% if asset.image_path %}
                <img src="{{ asset.image_path }}" alt="{{ asset.name }}">
            {% else %}
                <img src="static/images/default.png" alt="{{ asset.name }}">
            {% endif %}
            <div class="text">{{ asset.name }}</div>
            <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
            <a class="next" onclick="plusSlides(1)">&#10095;</a>
        </div>
    {% endfor %}
    </div>

    <!-- JavaScript function for filtering the table -->
    <script>
        function filterNames() {
            var input, filter, table, tr, td, i, txtValue;
            var counter = 0;
            var maxItems = 50; // Set the maximum number of items to display

            input = document.getElementById("nameFilter");
            filter = input.value.toUpperCase();
            table = document.getElementById("asset-table");
            tr = table.getElementsByTagName("tr");

            // Loop through all table rows, and hide those that don't match the search query or exceed the maximum number of items
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[0]; // Index 0 corresponds to the first column (Name)
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        if (counter < maxItems) {
                            tr[i].style.display = "";
                            counter++;
                        } else {
                            tr[i].style.display = "none";
                        }
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    var slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    function showSlides(n) {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        if (n > slides.length) { slideIndex = 1; }
        if (n < 1) { slideIndex = slides.length; }
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slides[slideIndex - 1].style.display = "flex";
    }    var slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    function showSlides(n) {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        if (n > slides.length) { slideIndex = 1; }
        if (n < 1) { slideIndex = slides.length; }
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slides[slideIndex - 1].style.display = "flex";
    }
    </script>
    {% endblock %}
</body>

</html>
